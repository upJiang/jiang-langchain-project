<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>LangChain.js 演示项目</title>
  <!-- 引入Vue 3 -->
  <script src="https://unpkg.com/vue@3/dist/vue.global.js"></script>
  <!-- 引入Element Plus -->
  <link rel="stylesheet" href="https://unpkg.com/element-plus/dist/index.css">
  <script src="https://unpkg.com/element-plus"></script>
  <!-- 引入Axios -->
  <script src="https://unpkg.com/axios/dist/axios.min.js"></script>
  <!-- 自定义样式 -->
  <link rel="stylesheet" href="css/style.css">
</head>
<body>
  <div id="app">
    <el-container>
      <el-header>
        <h1>LangChain.js 演示项目</h1>
      </el-header>
      
      <el-container>
        <el-aside width="200px">
          <el-menu 
            :default-active="activeIndex" 
            class="menu" 
            @select="handleSelect"
          >
            <el-menu-item index="1">
              <el-icon><el-icon-chat-dot-round /></el-icon>
              <span>基本对话链</span>
            </el-menu-item>
            <el-menu-item index="2">
              <el-icon><el-icon-connection /></el-icon>
              <span>代理与工具</span>
            </el-menu-item>
            <el-menu-item index="3">
              <el-icon><el-icon-search /></el-icon>
              <span>RAG检索</span>
            </el-menu-item>
            <el-menu-item index="4">
              <el-icon><el-icon-data-analysis /></el-icon>
              <span>数据库集成</span>
            </el-menu-item>
            <el-menu-item index="5">
              <el-icon><el-icon-cloudy /></el-icon>
              <span>天气预报</span>
            </el-menu-item>
          </el-menu>
        </el-aside>
        
        <el-main>
          <!-- 基本对话链 -->
          <div v-if="activeIndex === '1'" class="component-container">
            <h2>基本对话链演示</h2>
            <div class="chat-container">
              <div class="chat-messages" ref="chatMessages">
                <div v-for="(msg, index) in chatMessages" :key="index" :class="['message', msg.role]">
                  <div class="message-content">{{ msg.content }}</div>
                </div>
              </div>
              <div class="chat-input">
                <el-input 
                  v-model="chatInput" 
                  placeholder="请输入您的问题..." 
                  @keyup.enter="sendChatMessage"
                ></el-input>
                <el-button type="primary" @click="sendChatMessage" :loading="chatLoading">发送</el-button>
              </div>
            </div>
          </div>

          <!-- 代理与工具 -->
          <div v-if="activeIndex === '2'" class="component-container">
            <h2>代理与工具演示</h2>
            <div class="chat-container">
              <div class="chat-messages" ref="agentMessages">
                <div v-for="(msg, index) in agentMessages" :key="index" :class="['message', msg.role]">
                  <div class="message-content">{{ msg.content }}</div>
                </div>
              </div>
              <div class="agent-tools">
                <p>可用工具: 天气查询, 城市天气比较, SQL查询, 表信息查询</p>
              </div>
              <div class="chat-input">
                <el-input 
                  v-model="agentInput" 
                  placeholder="请输入您的指令..." 
                  @keyup.enter="sendAgentMessage"
                ></el-input>
                <el-button type="primary" @click="sendAgentMessage" :loading="agentLoading">发送</el-button>
              </div>
            </div>
          </div>

          <!-- RAG检索 -->
          <div v-if="activeIndex === '3'" class="component-container">
            <h2>RAG检索演示</h2>
            <div class="rag-container">
              <div class="rag-messages" ref="ragMessages">
                <div v-for="(msg, index) in ragMessages" :key="index" :class="['message', msg.role]">
                  <div class="message-content">{{ msg.content }}</div>
                </div>
              </div>
              <div class="chat-input">
                <el-input 
                  v-model="ragInput" 
                  placeholder="请输入关于LangChain的问题..." 
                  @keyup.enter="sendRagQuery"
                ></el-input>
                <el-button type="primary" @click="sendRagQuery" :loading="ragLoading">查询</el-button>
              </div>
            </div>
          </div>

          <!-- 数据库集成 -->
          <div v-if="activeIndex === '4'" class="component-container">
            <h2>数据库集成演示</h2>
            <div class="database-container">
              <div class="database-console" ref="dbMessages">
                <div v-for="(msg, index) in dbMessages" :key="index" :class="['message', msg.role]">
                  <div class="message-content">{{ msg.content }}</div>
                </div>
              </div>
              <div class="example-queries">
                <p>示例查询:</p>
                <el-tag @click="useExampleQuery(1)">数据库中有哪些表？</el-tag>
                <el-tag @click="useExampleQuery(2)">users表的结构是什么样的？</el-tag>
                <el-tag @click="useExampleQuery(3)">获取所有用户的信息</el-tag>
                <el-tag @click="useExampleQuery(4)">获取所有天气记录</el-tag>
                <el-tag @click="useExampleQuery(5)">查找温度高于28度的城市</el-tag>
              </div>
              <div class="chat-input">
                <el-input 
                  v-model="dbInput" 
                  placeholder="请输入数据库查询..." 
                  @keyup.enter="sendDbQuery"
                ></el-input>
                <el-button type="primary" @click="sendDbQuery" :loading="dbLoading">查询</el-button>
              </div>
            </div>
          </div>

          <!-- 天气预报 -->
          <div v-if="activeIndex === '5'" class="component-container">
            <h2>天气预报演示</h2>
            <div class="weather-container">
              <div class="weather-tabs">
                <el-tabs v-model="weatherTab">
                  <el-tab-pane label="实时天气查询" name="query">
                    <div class="weather-query">
                      <el-input 
                        v-model="weatherCity" 
                        placeholder="请输入城市名称"
                      ></el-input>
                      <el-button type="primary" @click="getWeatherReport" :loading="weatherLoading">查询</el-button>
                    </div>
                    <div class="weather-result" v-if="weatherReport">
                      <h3>{{ weatherReport.city }} 天气报告</h3>
                      <div class="weather-data">
                        <p>温度: {{ weatherReport.temperature }}°C</p>
                        <p>天气: {{ weatherReport.condition }}</p>
                        <p>风向: {{ weatherReport.windDirection }}</p>
                        <p>风力: {{ weatherReport.windScale }}级</p>
                        <p>湿度: {{ weatherReport.humidity }}%</p>
                      </div>
                    </div>
                  </el-tab-pane>
                  <el-tab-pane label="定时天气推送" name="schedule">
                    <div class="weather-schedule">
                      <el-form label-width="100px">
                        <el-form-item label="城市名称">
                          <el-input v-model="scheduleCity"></el-input>
                        </el-form-item>
                        <el-form-item label="推送时间">
                          <el-time-picker v-model="scheduleTime" format="HH:mm"></el-time-picker>
                        </el-form-item>
                        <el-form-item label="推送频率">
                          <el-select v-model="scheduleFrequency">
                            <el-option label="每天" value="daily"></el-option>
                            <el-option label="工作日" value="weekday"></el-option>
                            <el-option label="周末" value="weekend"></el-option>
                          </el-select>
                        </el-form-item>
                        <el-form-item>
                          <el-button type="primary" @click="scheduleWeatherReport" :loading="scheduleLoading">设置推送</el-button>
                        </el-form-item>
                      </el-form>
                      <div class="schedule-list" v-if="schedulesList.length > 0">
                        <h3>已设置的推送</h3>
                        <el-table :data="schedulesList">
                          <el-table-column prop="id" label="ID" width="60"></el-table-column>
                          <el-table-column prop="city" label="城市"></el-table-column>
                          <el-table-column prop="time" label="时间"></el-table-column>
                          <el-table-column prop="frequency" label="频率"></el-table-column>
                          <el-table-column label="操作">
                            <template #default="scope">
                              <el-button size="small" type="danger" @click="cancelSchedule(scope.row.id)">取消</el-button>
                            </template>
                          </el-table-column>
                        </el-table>
                      </div>
                    </div>
                  </el-tab-pane>
                </el-tabs>
              </div>
            </div>
          </div>
        </el-main>
      </el-container>
    </el-container>
  </div>

  <!-- 引入Vue应用脚本 -->
  <script src="js/app.js"></script>
</body>
</html> 